# Mushenji Bot

一个基于 `aiogram` 的修仙题材 Telegram 机器人脚本，提供闭关修炼、丹药服用、图鉴、炼制、宗门与任务等玩法，并包含限量物品库存与管理指令。

## 功能概览

- **修炼系统**：闭关修炼/深度闭关、丹毒影响、闭关掉落素材。
- **物品与图鉴**：丹药/武器/护具/材料/配方图鉴，展示数值与需求。
- **炼制系统**：通过丹方/武器方/护具方消耗材料与灵石炼制物品。
- **宗门与任务**：加入宗门领取入门配方与材料，任务获取材料、灵石与配方。
- **限量物品**：限量武器/护具/道具库存管理。
- **榜单**：灵石榜、修为榜。

## 目录结构

- `mushenji_bot.py`：主脚本。
- `requirements.txt`：Python 依赖。
- `data/`：运行时 SQLite 数据库目录。

## 安装与运行

1. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

2. 设置环境变量（示例）：
   ```bash
   export TELEGRAM_BOT_TOKEN="<your-telegram-bot-token>"
   export ADMIN_USER_IDS="123456,789012"
   ```

3. 启动机器人：
   ```bash
   python mushenji_bot.py
   ```

> 数据库默认位置：`data/mushenji.sqlite3`。首次启动会自动初始化表结构。

## 玩家常用指令

- `.检测灵体`：创建角色并检测灵体。
- `.我的灵体`：查看角色档案。
- `.我的配方`：查看已学配方。
- `.闭关修炼` / `.深度闭关`：修炼。
- `.查看闭关` / `.强行出关`：查看或终止深度闭关。
- `.储物袋`：查看背包。
- `.服用 丹药名*数量`：服用丹药。
- `.炼制 配方名/目标物品*数量`：消耗材料炼制。
- `.图鉴 类别`：查看物品图鉴。
- `.宗门 查看/加入/信息/任务/签到/兑换`：宗门系统。
- `.任务`：领取任务奖励（有冷却）。
- `.榜单 灵石/修为`：查看排行榜。

## 管理员指令（天道）

管理员 ID 需在 `ADMIN_USER_IDS` 中配置。

- `.天道 帮助`：查看所有管理指令。
- `.天道 查档 用户ID`：查询角色信息。
- `.天道 设置修为/境界/灵石`：修改数值。
- `.天道 发放 用户ID 物品名 数量`：发放物品（限量物品会扣库存）。
- `.天道 限量库存`：查看限量库存。
- `.天道 设置限量/加限量/扣限量 物品名 数量`：管理限量库存。

## 图鉴类别

可用分类示例：

- `丹药`、`超稀有丹药`
- `武器`、`限量武器`
- `护具`、`限量防具`
- `材料`
- `丹方`、`武器方`、`护具方`
- `限量道具`

## 注意事项

- 目前玩法为单脚本实现，适合小规模运行。
- 若需扩展剧情/玩法，可在 `mushenji_bot.py` 中增补物品与规则。
